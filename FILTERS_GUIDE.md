# 🔍 筛选功能使用指南

## ✨ 新增功能

现在支持在导入时使用筛选条件，有选择性地导入期刊！

## 📊 界面预览

```
┌─────────────────────────────────────────────┐
│ 从 API 同步期刊数据                          │
├─────────────────────────────────────────────┤
│ API URL                                     │
│ [https://your-api.com              ]        │
│                                             │
│ [测试连接] [显示筛选 ▼]                      │
│                                             │
│ ┌─────────────────────────────────────────┐ │
│ │ 筛选条件                                 │ │
│ │                                         │ │
│ │ [搜索关键词: science      ]              │ │
│ │ [是否在DOAJ中: 是 ▼]                    │ │
│ │ [是否在NLM中: 全部 ▼]                   │ │
│ │ [是否有Wikidata: 全部 ▼]                │ │
│ │ [是否开放获取: 是 ▼]                     │ │
│ │                                         │ │
│ │ [清除筛选]  ✅ 已应用 2 个筛选条件        │ │
│ └─────────────────────────────────────────┘ │
│                                             │
│ [🧪 导入第一页] [🚀 导入所有数据]            │
└─────────────────────────────────────────────┘
```

## 🎯 筛选条件说明

### 1. 搜索关键词 (q)

**类型**: 文本输入  
**说明**: 搜索 ISSN、标题、出版商

**示例**:
- `science` - 包含 "science" 的期刊
- `nature` - 包含 "nature" 的期刊
- `2073-4395` - 特定 ISSN

### 2. 是否在 DOAJ 中 (inDoaj)

**类型**: 下拉选择  
**选项**:
- `全部` - 不筛选
- `是` - 只导入 DOAJ 收录的期刊
- `否` - 只导入非 DOAJ 期刊

**用途**: 筛选高质量开放获取期刊

### 3. 是否在 NLM 中 (inNlm)

**类型**: 下拉选择  
**选项**:
- `全部` - 不筛选
- `是` - 只导入 NLM/PubMed 收录的期刊
- `否` - 只导入非 NLM 期刊

**用途**: 筛选医学/生命科学期刊

### 4. 是否有 Wikidata (hasWikidata)

**类型**: 下拉选择  
**选项**:
- `全部` - 不筛选
- `是` - 只导入有 Wikidata 记录的期刊
- `否` - 只导入无 Wikidata 记录的期刊

**用途**: 筛选数据完整性高的期刊

### 5. 是否开放获取 (isOpenAccess)

**类型**: 下拉选择  
**选项**:
- `全部` - 不筛选
- `是` - 只导入开放获取期刊
- `否` - 只导入订阅型期刊

**用途**: 筛选 OA 期刊

## 📋 使用场景

### 场景1：只导入 DOAJ 开放获取期刊

1. 点击"显示筛选"
2. "是否在 DOAJ 中" → 选择 `是`
3. "是否开放获取" → 选择 `是`
4. 点击"导入所有数据"

**结果**: 只导入 DOAJ 中的开放获取期刊

---

### 场景2：搜索特定主题期刊

1. 点击"显示筛选"
2. "搜索关键词" → 输入 `medicine`
3. 点击"导入第一页（测试）"查看结果
4. 确认后点击"导入所有数据"

**结果**: 只导入标题/出版商包含 "medicine" 的期刊

---

### 场景3：导入高质量医学期刊

1. 点击"显示筛选"
2. "是否在 NLM 中" → 选择 `是`
3. "是否有 Wikidata" → 选择 `是`
4. 点击"导入所有数据"

**结果**: 只导入 NLM 收录且有 Wikidata 的医学期刊

---

### 场景4：筛选特定 ISSN

1. 点击"显示筛选"
2. "搜索关键词" → 输入 `2073-4395`
3. 点击"导入第一页"

**结果**: 只导入匹配该 ISSN 的期刊

---

## 🔄 筛选条件组合

筛选条件可以**组合使用**，多个条件是 **AND** 关系。

### 示例：顶级开放获取期刊

```
✅ 是否在 DOAJ 中: 是
✅ 是否有 Wikidata: 是
✅ 是否开放获取: 是
```

只导入同时满足以上3个条件的期刊。

### 示例：非 OA 的医学期刊

```
✅ 是否在 NLM 中: 是
✅ 是否开放获取: 否
```

导入 NLM 收录但非开放获取的期刊。

## 💡 最佳实践

### 1. 先测试再全量导入

```
1. 设置筛选条件
2. 点击"导入第一页（测试）"
3. 查看创建的话题
4. 确认数据正确
5. 点击"导入所有数据"
```

### 2. 清除筛选

如果要导入所有数据：
- 点击"清除筛选"按钮
- 或手动将所有下拉框设置为"全部"

### 3. 查看当前筛选

界面底部会显示：
- `暂无筛选条件` - 没有筛选
- `✅ 已应用 2 个筛选条件` - 有筛选

### 4. 筛选条件会保存

在导入过程中，筛选条件会被记录并显示在进度消息中：

```
开始导入所有数据...（筛选：DOAJ期刊、开放获取）
```

## 📊 性能影响

### 无筛选

- **15万期刊** → 约 50 分钟

### 有筛选（DOAJ期刊）

- **~2万期刊** → 约 7 分钟

### 有筛选（特定关键词）

- **~100-1000期刊** → 约 1-5 分钟

**结论**: 筛选可以大幅缩短导入时间！

## 🔍 API 请求示例

### 无筛选

```
GET /api/public/journals?page=1&pageSize=100
```

### 有筛选

```
GET /api/public/journals?page=1&pageSize=100&inDoaj=true&isOpenAccess=true
```

### 多条件筛选

```
GET /api/public/journals?page=1&pageSize=100&q=science&inDoaj=true&hasWikidata=true
```

## ⚠️ 注意事项

1. **测试连接不受筛选影响**
   - "测试连接"按钮总是获取所有期刊的总数
   
2. **筛选是服务器端的**
   - 筛选由你的 API 处理
   - 确保 API 正确实现筛选逻辑

3. **空结果**
   - 如果筛选条件太严格，可能导致 0 个结果
   - 先用"导入第一页"测试

4. **筛选条件持久化**
   - 筛选条件不会自动保存
   - 每次访问页面需要重新设置

## 🎯 总结

| 功能 | 说明 |
|------|------|
| 显示/隐藏筛选 | 点击按钮切换 |
| 5个筛选条件 | 可任意组合 |
| 清除筛选 | 一键清除所有条件 |
| 实时提示 | 显示已应用的条件数 |
| 测试导入 | 先测试后全量 |
| 进度显示 | 显示筛选条件 |

---

**享受强大的筛选功能！** 🎉

根据需求灵活导入期刊数据，节省时间和资源！
